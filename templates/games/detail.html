{% extends 'base.html' %}
{% load static %}

{% block title %}Pirogrammer Card Game{% endblock %}

{% block content %}
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;700&display=swap" rel="stylesheet">
<link rel="stylesheet" type="text/css" href="{% static 'css/games/detail.css' %}">

<div class="game-container">
    <h1 class="game-title">ğŸƒ ìš´ëª…ì˜ ì¹´ë“œ ëŒ€ê²° #{{ game_index }} ğŸƒ</h1>
    <p class="game-subtitle">{{ game.player1.nickname }} VS {{ game.player2.nickname }}</p>

    {% if game.status == 'PENDING' %}
        <h2 class="section-title">ğŸ­ ê²Œì„ ì§„í–‰ ì¤‘...</h2>
        
        {% if game.player1 == request.user or game.player2 == request.user %}
            <p class="card-instruction">ë‹¹ì‹ ì˜ ì„ íƒí•œ ì¹´ë“œ:</p>
            <div class="card-container">
                <div class="card selected">
                    {% if game.player1 == request.user %}
                        {{ game.player1_card }}
                    {% else %}
                        {{ game.player2_card }}
                    {% endif %}
                </div>
            </div>
        {% endif %}
        
        <p class="opponent-message">ìƒëŒ€ë°©ì˜ ì„ íƒì„ ê¸°ë‹¤ë¦¬ê³  ìˆìŠµë‹ˆë‹¤...</p>
    {% endif %}

    {% if game.status == 'COMPLETED' %}
        <h2 class="section-title">ğŸ† ê²Œì„ ê²°ê³¼</h2>
        <p class="result">{{ game.result }}</p>
        <p class="score">{{ game.player1_card }} : {{ game.player2_card }}</p>
        <p class="win-condition">ìŠ¹ë¦¬ ì¡°ê±´: {{ game.get_win_condition_display }}</p>
    {% endif %}

    <p class="game-info">ìƒì„±ì¼: {{ game.created_at }}</p>

    <div class="action-buttons">
        {% if game.status == 'PENDING' and game.player1 == request.user %}
            <form action="{% url 'games:cancel' game.pk %}" method="post" style="display: inline;">
                {% csrf_token %}
                <button type="submit" class="action-button btn-danger">ê²Œì„ ì·¨ì†Œ</button>
            </form>
        {% endif %}
        <a href="{% url 'games:list' %}" class="action-button btn-secondary">ì „ì  ëª©ë¡</a>
    </div>
</div>
{% endblock %}